--1
SELECT AI.CUSTOMER_ID, AI.ACCOUNT_TYPE, AI.ACCOUNT_NO, BI.BANK_NAME
FROM BANK_INFO BI
INNER JOIN ACCOUNT_INFO AI
ON BI.IFSC_CODE=AI.IFSC_CODE;

--2
SELECT AI.CUSTOMER_ID, AI.ACCOUNT_TYPE, AI.ACCOUNT_NO
FROM ACCOUNT_INFO AI
INNER JOIN BANK_INFO BI
ON AI.IFSC_CODE=BI.IFSC_CODE
WHERE AI.REGISTRATION_DATE BETWEEN to_date('2012-01-13','yyyy-mm-dd') AND to_date('2012-04-03','yyyy-mm-dd') AND BI.BANK_NAME='HDFC';

--3
SELECT CI.CUSTOMER_ID, CI.CUSTOMER_NAME, AI.ACCOUNT_NO, AI.ACCOUNT_TYPE, BI.BANK_NAME FROM  bank_info BI 
INNER JOIN account_info AI ON AI.IFSC_CODE = BI.IFSC_CODE 
INNER JOIN customer_personal_info CI ON CI.CUSTOMER_ID = AI.CUSTOMER_ID AND AI.ACCOUNT_NO IS NOT NULL; 

--4
SELECT CUSTOMER_ID, CUSTOMER_NAME, GENDER, MARITAL_STATUS, CONCAT(CUSTOMER_NAME, CONCAT('_', CONCAT(GENDER, CONCAT('_', MARITAL_STATUS)))) AS 
UNIQUE_REF_STRING FROM CUSTOMER_PERSONAL_INFO ORDER BY CUSTOMER_ID DESC; 

--5
SELECT ACCOUNT_NO, CUSTOMER_ID, REGISTRATION_DATE, INITIAL_DEPOSIT FROM ACCOUNT_INFO WHERE INITIAL_DEPOSIT > 15000 AND INITIAL_DEPOSIT < 25000;

--6
SELECT CUSTOMER_ID, CUSTOMER_NAME, DATE_OF_BIRTH, GUARDIAN_NAME FROM customer_personal_info WHERE CUSTOMER_NAME LIKE 'J%';

--7
SELECT CUSTOMER_ID, ACCOUNT_NO, CONCAT(SUBSTR(CUSTOMER_ID, -3), SUBSTR(ACCOUNT_NO, -4)) AS PASSWORD FROM ACCOUNT_INFO;

--8
SELECT CUSTOMER_ID, CUSTOMER_NAME, DATE_OF_BIRTH, GUARDIAN_NAME, CONTACT_NO, MAIL_ID, GENDER, MARITAL_STATUS FROM customer_personal_info
WHERE GENDER = 'M' AND MARITAL_STATUS = 'MARRIED';

--9
SELECT CI.CUSTOMER_ID, CI.CUSTOMER_NAME, CI.GUARDIAN_NAME, RI.REFERENCE_ACC_NAME FROM customer_reference_info RI INNER JOIN 
customer_personal_info CI ON CI.CUSTOMER_ID = RI.CUSTOMER_ID WHERE RELATION = 'FRIEND';

--10
SELECT CUSTOMER_ID, ACCOUNT_NO, CONCAT('$', INTEREST) AS INTEREST_AMT FROM ACCOUNT_INFO ORDER BY INTEREST;

--11
SELECT CI.CUSTOMER_NAME, AI.CUSTOMER_ID, AI.ACCOUNT_NO, AI.ACCOUNT_TYPE, ACTIVATION_DATE, BI.BANK_NAME FROM BANK_INFO BI 
INNER JOIN ACCOUNT_INFO AI ON AI.IFSC_CODE = BI.IFSC_CODE
INNER JOIN customer_personal_info CI ON AI.CUSTOMER_ID = ci.customer_id WHERE AI.ACTIVATION_DATE = '2012-04-10';

SELECT * FROM ACCOUNT_INFO;

--12
SELECT AI.ACCOUNT_NO, CI.CUSTOMER_ID, CI.CUSTOMER_NAME, BI.BANK_NAME, BI.BRANCH_NAME, BI.IFSC_CODE, CI.CITIZENSHIP, 
AI.INTEREST, AI.INITIAL_DEPOSIT FROM account_info AI 
INNER JOIN customer_personal_info CI ON AI.CUSTOMER_ID = CI.CUSTOMER_ID
INNER JOIN bank_info BI ON BI.IFSC_CODE = AI.IFSC_CODE;

--13
SELECT CI.CUSTOMER_ID, CI.CUSTOMER_NAME, CI.DATE_OF_BIRTH, CI.GUARDIAN_NAME, CI.CONTACT_NO, CI.MAIL_ID, RI.REFERENCE_ACC_NAME
FROM customer_personal_info CI INNER JOIN customer_reference_info RI ON CI.CUSTOMER_ID = RI.CUSTOMER_ID 
WHERE IDENTIFICATION_DOC_TYPE = 'PASSPORT';

--14
SELECT CI.CUSTOMER_NAME, CI.CUSTOMER_ID, AI.ACCOUNT_NO, AI.ACCOUNT_TYPE, AI.INITIAL_DEPOSIT, AI.INTEREST 
FROM ACCOUNT_INFO AI INNER JOIN customer_personal_info CI ON AI.CUSTOMER_ID = CI.CUSTOMER_ID
WHERE AI.INITIAL_DEPOSIT = (SELECT MAX(AI.INITIAL_DEPOSIT) FROM account_info AI);

--15
SELECT CI.CUSTOMER_ID, CI.CUSTOMER_NAME, AI.ACCOUNT_NO, AI.ACCOUNT_TYPE, AI.INTEREST, AI.INITIAL_DEPOSIT, BI.BANK_NAME
FROM BANK_INFO BI INNER JOIN ACCOUNT_INFO AI ON AI.IFSC_CODE = BI.IFSC_CODE
INNER JOIN customer_personal_info CI ON AI.CUSTOMER_ID = CI.CUSTOMER_ID WHERE AI.INTEREST = (SELECT MAX(AI.INTEREST) FROM account_info AI);

--16
SELECT CI.CUSTOMER_ID, CI.CUSTOMER_NAME, AI.ACCOUNT_NO, BI.BANK_NAME, CI.CONTACT_NO, CI.MAIL_ID FROM customer_personal_info CI
INNER JOIN account_info AI ON AI.CUSTOMER_ID = CI.CUSTOMER_ID
INNER JOIN BANK_INFO BI ON BI.IFSC_CODE = AI.IFSC_CODE WHERE ADDRESS LIKE '%BANGALORE';

--17
SELECT AI.CUSTOMER_ID, BI.BANK_NAME, BI.BRANCH_NAME, BI.IFSC_CODE, AI.REGISTRATION_DATE, AI.ACTIVATION_DATE
FROM account_info AI INNER JOIN bank_info BI ON AI.IFSC_CODE = BI.IFSC_CODE
WHERE to_char(AI.ACTIVATION_DATE,'MM')=03;

--18
SELECT CPI.CUSTOMER_ID, CPI.CUSTOMER_NAME, AI.ACCOUNT_NO, AI.ACCOUNT_TYPE, AI.INTEREST, AI.INITIAL_DEPOSIT, 
((INTEREST/100)*INITIAL_DEPOSIT) AS INTEREST_AMT
FROM CUSTOMER_PERSONAL_INFO CPI
INNER JOIN ACCOUNT_INFO AI
ON CPI.CUSTOMER_ID=AI.CUSTOMER_ID;

--19
SELECT CI.CUSTOMER_ID, CI.CUSTOMER_NAME, CI.DATE_OF_BIRTH, CI.GUARDIAN_NAME, CI.CONTACT_NO, CI.MAIL_ID, RI.REFERENCE_ACC_NAME
FROM customer_personal_info CI INNER JOIN customer_reference_info RI ON CI.CUSTOMER_ID = RI.CUSTOMER_ID
WHERE RI.REFERENCE_ACC_NAME = 'RAGHUL';

--20
SELECT CUSTOMER_ID, CUSTOMER_NAME, 
CONCAT('+91-',CONCAT(SUBSTR(CONTACT_NO,1,3),CONCAT('-',CONCAT(SUBSTR(CONTACT_NO,4,3),CONCAT('-',SUBSTR(CONTACT_NO,-4))))))
AS CONTACT_ISD FROM customer_personal_info;

